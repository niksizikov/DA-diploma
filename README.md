# Что нужно сделать

Итак, **ваша задача** — изучить предоставленный датасет, ответить на вопросы из общей части (подразумевающей базовую обработку данных и их разведочный анализ) и выполнить задание по специализации, в которой вы хотели бы развиваться в будущем.

Шаги по каждому пункту и вопросы будут дальше, в разделе «План работы».

В финальной работе представлены задачи для трёх специализаций.

## 1 Дата аналитик:

Разбирается в математической статистике, умеет формулировать   и исследовать гипотезы. Владеет инструментами Business Intelligence, которые помогают исследовать данные и переводить информацию, которая   в них содержится, на язык бизнеса, понятный людям, которые принимают то или иное управленческое решение.

# Глоссарий

**Целевое действие** — события типа «Оставить заявку» и «Заказать звонок» (ga_hits.event_action in ['sub_car_claim_click', 'sub_car_claim_submit_click', 'sub_open_dialog_click', 'sub_custom_question_submit_click', 'sub_call_number_click', 'sub_callback_submit_click', 'sub_submit_success', 'sub_car_request_submit_click']).

**CR (Conversion Rate)** — показатель конверсии из визита (уникальный session_id) в любое целевое действие в рамках одного визита (в случае наличия >1 целевого действия — считать все как одно).

**Органический трафик** — все визиты с ga_sessions.utm_medium in ('organic', 'referral', '(none)').

**Платный трафик** — весь неорганический трафик. Информация про марку и модель авто — содержится в ga_hits.hit_page_path.

**Реклама в социальных сетях** — все визиты с ga_sessions.utm_source in ('QxAxdyPLuQMEcrdZWdWb', 'MvfHsxITijuriZxsqZqt', 'ISrKoXQCxqqYvAZICvjs', IZEXUFLARCUMynmHNBGo', 'PlbkrSYoHuZBWfYjYnfw', 'gVRrcxiDQubJiljoTbGm').

# План работы

**Проведите подготовительную работу (1 час):**
	- Прочитайте предоставленный датасет.
	- Ознакомьтесь с описаниями представленных атрибутов.
	- Оцените полноту и чистоту данных. Попытайтесь понять, что стоит   за этими данными в реальном мире. Приведите данные в удобный / нормальный вид для дальнейшей работы.

**Проведите разведочный анализ данных (4 часа):**
	- Проведите базовую чистку (дубликаты, пустые значения, типизация данных, ненужные атрибуты).
	- Посмотрите на распределение ключевых атрибутов, их отношения.

**Выполните задание согласно вашей специализации   (18 часов):**

Проведите проверку следующих гипотез:
	- Органический трафик не отличается от платного с точки зрения CR (Conversion Rate) в целевые события.
	- Трафик с мобильных устройств не отличается от трафика  с десктопных устройств с точки зрения CR (Conversion Rate)   в целевые события.
	- Трафик из городов присутствия (Москва и область, Санкт-Петербург)   не отличается от трафика из иных регионов с точки зрения CR (Conversion Rate) в целевые события.

Дайте ответы на вопросы продуктовой команды:
	- Из каких источников / кампаний / устройств / локаций к нам идёт самый целевой трафик (и с точки зрения объёма трафика, и с точки зрения CR)?
	- Какие авто пользуются наибольшим спросом? У каких авто самый лучший показатель CR (Conversion Rate) в целевые события?
	- Стоит ли нам увеличивать своё присутствие в соцсетях и давать там больше рекламы?

**Подготовьте получившиеся артефакты, проверьте их   на соответствие итоговым критериям оценки и сдайте их   (2 часа).**

# Формат решения

**Общее:**
	- Формат файла — Jupyter Notebook
	- Содержание — код для чтения, обработки и EDA; получившиеся графики и текстовые комментарии, а также выводы по данным.

**DA:**
	- Формат файла — Jupyter Notebook.
	- Содержание — результаты проверки гипотез в формате «Гипотеза — Статистические критерий и тест — Результат теста — Текстовая интерпретация результата».

# Критерии оценки

## Общая часть

### EDA:

- Корректная обработка данных: выброшены пустые атрибуты, убраны дубликаты, обработаны NaN-значения, таблицы сцеплены корректно.
- Наличие релевантных визуализаций — подразумевается наличие визуализаций распределений (histogram / boxplot), опционально — динамика визитов и событий во времени
- Нахождение основных корреляций (heatmap + выводы по полученным связям).

## Специализации

### DA:

1. Проверка гипотез. Для каждой гипотезы:
	1. Корректность выбранного метода.
	2. Корректность выбранных параметров теста (мощность и прочее).
	3. Корректность реализации теста на Python.
2. Ответы на вопросы бизнеса (оценка отраслевого эксперта):
	1. Основанность на данных — ответы являются фактически корректными и не содержат утверждений, противоречащих предоставленным данным.
	2. Business Acumen — ответы демонстрируют понимание основ маркетинговой аналитики и/или автомобильного рынка.
	3. Интерпретируемость — ответ даёт однозначное решение поставленного вопроса и не требует дополнительной трактовки или расширенного комментария

# Описание данных

Данные из Google Analytics (last-click attribution model) по сайту «СберАвтоподписка».

### 1. GA Sessions (ga_sessions.pkl)

Одна строка = один визит на сайт.

Описание атрибутов:
  - session_id — ID визита;
  - client_id — ID посетителя;
  - visit_date — дата визита;
  - visit_time — время визита;
  - visit_number — порядковый номер визита клиента;
  - utm_source — канал привлечения;
  - utm_medium — тип привлечения;
  - utm_campaign — рекламная кампания;
  - utm_keyword — ключевое слово;
  - device_category — тип устройства;
  - device_os — ОС устройства;
  - device_brand — марка устройства;
  - device_model — модель устройства;
  - device_screen_resolution — разрешение экрана;
  - device_brand — марка устройства;
  - device_model — модель устройства;
  - device_screen_resolution — разрешение экрана;
  - device_browser — браузер;
  - geo_country — страна;
  - geo_city — город.
### 2. GA Hits (ga_hits.pkl)

Одна строка = одно событие в рамках одного визита на сайт.

Описание атрибутов:
  - session_id — ID визита;
  - hit_date — дата события;
  - hit_time — время события;
  - hit_number — порядковый номер события в рамках сессии;
  - hit_type — тип события;
  - hit_referer — источник события;
  - hit_page_path — страница события;
  - event_category — тип действия;
  - event_action — действие;
  - event_label — тег действия;
  - event_value — значение результата действия

# Полезные материалы для выполнения проекта. ROC-AUC

Вспомните матрицу ошибок в Python. В ней есть четыре элемента:
  - **TN** (True Negative) — элементы, верно классифицированные как класс 0.
  - **TP** (True Positive) — элементы, верно классифицированные как класс 1.
  - **FN** (False Negative) — элементы, неверно классифицированные как класс 0.
  - **FP** (False Positive) — элементы, неверно классифицированные как класс

![image](https://github.com/user-attachments/assets/22a3c982-75e1-4fb4-90c5-11e34b44d632)

Введём новые понятия:
  - **TPR (True positive rate)** — доля верно предсказанных классов у объектов, относящихся к положительному классу.

$$TRP = \frac{TP}{TP + FN}$$

  - **FPR (False positive Rate)** — доля неправильно предсказанных классов среди объектов отрицательного класса.

$$FRP = \frac{FP}{TN + FP}$$

  - **ROC-кривая (Receiver operating Characteristic)** — кривая, которая описывает взаимосвязь между чувствительностью модели (TPR — доля истинно положительных примеров) и её специфичностью (описываемой в отношении долей ложноположительных результатов — 1-FPR).

Предположим, у вас есть модель логистической регрессии, которая решает некоторую задачу бинарной классификации. При этом она предсказывает не только 0 и 1, но и может предсказывать вероятности отношения к классу 0 и к классу 1 с помощью метода predict_proba.

Пусть эта модель предсказала четыре вероятности отношения объекта к классу 1 (колонка predict_proba). Если мы возьмём стандартный порог, равный 0.5, то в результате предикта мы получим классы из колонки 2. Если же попробуем варьировать порог и выберем его равным 0.9, то получим значения из последней колонки.

![image](https://github.com/user-attachments/assets/debd1560-27e8-45ee-9104-b3793291106d)

Тогда при $trsh=0.5 TPR$ будет равен $\frac{2}{(2+0)} = 1$, а $FPR=\frac{1}{(1+1)} = \frac{1}{2}$.

При $trsh=0.9 TPR$ будет равен $\frac{1}{(1+1)} = \frac{1}{2}$, а $FPR=0$.

ROC-кривая — это зависимость TPR от FPR. Таким образом, мы получили две точки для ROC-кривой: $(\frac{1}{2}, 1)$ и $(0, \frac{1}{2})$. Кривая начинается в начале координат и стремится к $(1,1)$. Чем больше значений трешхолда мы исследуем, тем детальнее получается кривая.

![image](https://github.com/user-attachments/assets/5dc5ec00-51b7-48f8-a736-e10f4fd8fed7)

ROC-AUC (AUC = area under the curve) — одна из метрик оценки качества бинарной классификации.

Чтобы оценить, насколько хорош классификатор, рассчитывают площадь под ROC-кривой. Значение, равное единице — это идеальный классификатор. Значение 0.5 — рандомный классификатор.

То есть идеальная модель та, в которой доля TPR максимально высока, а доля FPR удерживается как можно ниже.

![image](https://github.com/user-attachments/assets/a4540db9-53c7-4bed-ab08-50c6be841577)

Значение метрики ROC-AUC вы сможете *посчитать с помощью функции* в sklearn, передав на вход истинные значения классов и вероятности предсказания модели.
